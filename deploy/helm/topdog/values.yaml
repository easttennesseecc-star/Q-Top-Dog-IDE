# Default values for Top Dog (Aura) chart.

replicaCount: 2

image:
  repository: ghcr.io/your-org/topdog
  tag: "latest"
  pullPolicy: IfNotPresent
  # pullSecrets:
  #   - name: regcred

# Image pull secrets for private registries (e.g., GHCR/DOCR)
imagePullSecrets: []

service:
  type: ClusterIP
  port: 8080

env:
  # Core app env vars
  MARKETPLACE_MODE: "directory"
  # Add provider keys via Kubernetes secrets and map in extraEnvFrom

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

livenessProbe:
  path: /healthz
  initialDelaySeconds: 10
  periodSeconds: 10

readinessProbe:
  path: /readyz
  initialDelaySeconds: 5
  periodSeconds: 10

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

ingress:
  enabled: true
  className: "nginx"
  annotations:
    # Enable HTTP Strict Transport Security (HSTS)
    nginx.ingress.kubernetes.io/hsts: "true"
    nginx.ingress.kubernetes.io/hsts-max-age: "31536000"
    nginx.ingress.kubernetes.io/hsts-include-subdomains: "true"
    nginx.ingress.kubernetes.io/hsts-preload: "true"
    # Security headers and caching rules
    nginx.ingress.kubernetes.io/configuration-snippet: |
      add_header X-Content-Type-Options "nosniff" always;
      add_header X-Frame-Options "SAMEORIGIN" always;
      add_header X-XSS-Protection "1; mode=block" always;
      add_header Referrer-Policy "strict-origin-when-cross-origin" always;
      add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;
      
      # Caching: long cache for static assets, no-store for HTML
      if ($request_uri ~* \.(js|css|png|jpg|jpeg|gif|svg|woff|woff2|ttf|eot)$) {
        add_header Cache-Control "public, max-age=31536000, immutable";
      }
      if ($request_uri ~* \.(html)$) {
        add_header Cache-Control "no-store";
      }
  # When true, ingress routes to the router service (<release>-router) instead of the default service
  useRouterService: false
  hosts:
    - host: topdog.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: topdog-tls
      hosts:
        - topdog.example.com

podAnnotations: {}

nodeSelector: {}

tolerations: []

affinity: {}

extraEnv: []
# - name: LOG_LEVEL
#   value: info

extraEnvFrom: []
# - secretRef:
#     name: provider-api-keys
